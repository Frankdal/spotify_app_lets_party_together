function cov_2931p54gwd(){var path="D:\\Mag\\lets_party_together\\potential-badass-app\\server\\server.js";var hash="44c87ad55328fbe5e45cde1d68abff27b597bc3d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\Mag\\lets_party_together\\potential-badass-app\\server\\server.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:14},end:{line:2,column:30}},"2":{start:{line:3,column:19},end:{line:3,column:41}},"3":{start:{line:4,column:20},end:{line:4,column:47}},"4":{start:{line:5,column:16},end:{line:5,column:44}},"5":{start:{line:6,column:16},end:{line:6,column:34}},"6":{start:{line:7,column:20},end:{line:7,column:52}},"7":{start:{line:9,column:12},end:{line:9,column:21}},"8":{start:{line:11,column:0},end:{line:11,column:51}},"9":{start:{line:12,column:0},end:{line:12,column:27}},"10":{start:{line:14,column:18},end:{line:14,column:52}},"11":{start:{line:16,column:0},end:{line:18,column:3}},"12":{start:{line:17,column:1},end:{line:17,column:39}},"13":{start:{line:21,column:1},end:{line:21,column:58}},"14":{start:{line:22,column:1},end:{line:22,column:64}},"15":{start:{line:23,column:1},end:{line:23,column:75}},"16":{start:{line:23,column:16},end:{line:23,column:75}},"17":{start:{line:26,column:0},end:{line:55,column:4}},"18":{start:{line:29,column:2},end:{line:29,column:39}},"19":{start:{line:30,column:18},end:{line:30,column:31}},"20":{start:{line:31,column:15},end:{line:31,column:30}},"21":{start:{line:32,column:14},end:{line:32,column:28}},"22":{start:{line:33,column:2},end:{line:38,column:3}},"23":{start:{line:34,column:3},end:{line:34,column:20}},"24":{start:{line:35,column:3},end:{line:35,column:37}},"25":{start:{line:37,column:3},end:{line:37,column:14}},"26":{start:{line:39,column:2},end:{line:47,column:3}},"27":{start:{line:40,column:17},end:{line:40,column:72}},"28":{start:{line:41,column:22},end:{line:41,column:24}},"29":{start:{line:42,column:3},end:{line:42,column:34}},"30":{start:{line:43,column:3},end:{line:43,column:42}},"31":{start:{line:45,column:16},end:{line:45,column:41}},"32":{start:{line:46,column:3},end:{line:46,column:38}},"33":{start:{line:50,column:2},end:{line:50,column:39}},"34":{start:{line:51,column:17},end:{line:51,column:30}},"35":{start:{line:52,column:13},end:{line:52,column:42}},"36":{start:{line:53,column:2},end:{line:54,column:50}},"37":{start:{line:53,column:20},end:{line:53,column:61}},"38":{start:{line:54,column:7},end:{line:54,column:50}},"39":{start:{line:57,column:0},end:{line:65,column:3}},"40":{start:{line:58,column:1},end:{line:58,column:39}},"41":{start:{line:59,column:11},end:{line:59,column:24}},"42":{start:{line:60,column:10},end:{line:60,column:27}},"43":{start:{line:61,column:13},end:{line:61,column:37}},"44":{start:{line:62,column:14},end:{line:62,column:51}},"45":{start:{line:63,column:1},end:{line:63,column:71}},"46":{start:{line:63,column:20},end:{line:63,column:71}},"47":{start:{line:64,column:1},end:{line:64,column:18}},"48":{start:{line:67,column:0},end:{line:106,column:4}},"49":{start:{line:70,column:2},end:{line:70,column:43}},"50":{start:{line:71,column:16},end:{line:71,column:32}},"51":{start:{line:72,column:17},end:{line:72,column:34}},"52":{start:{line:74,column:19},end:{line:74,column:53}},"53":{start:{line:75,column:14},end:{line:75,column:43}},"54":{start:{line:76,column:15},end:{line:76,column:76}},"55":{start:{line:77,column:2},end:{line:80,column:76}},"56":{start:{line:78,column:3},end:{line:80,column:76}},"57":{start:{line:82,column:13},end:{line:82,column:62}},"58":{start:{line:84,column:2},end:{line:87,column:69}},"59":{start:{line:85,column:3},end:{line:87,column:69}},"60":{start:{line:88,column:2},end:{line:88,column:53}},"61":{start:{line:88,column:23},end:{line:88,column:53}},"62":{start:{line:90,column:24},end:{line:94,column:3}},"63":{start:{line:96,column:2},end:{line:96,column:67}},"64":{start:{line:99,column:2},end:{line:99,column:42}},"65":{start:{line:100,column:16},end:{line:100,column:33}},"66":{start:{line:101,column:19},end:{line:101,column:53}},"67":{start:{line:102,column:14},end:{line:102,column:43}},"68":{start:{line:103,column:13},end:{line:103,column:62}},"69":{start:{line:104,column:2},end:{line:105,column:34}},"70":{start:{line:104,column:19},end:{line:104,column:68}},"71":{start:{line:105,column:7},end:{line:105,column:34}},"72":{start:{line:108,column:0},end:{line:110,column:3}},"73":{start:{line:109,column:1},end:{line:109,column:44}},"74":{start:{line:112,column:0},end:{line:112,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:19},end:{line:16,column:20}},loc:{start:{line:16,column:33},end:{line:18,column:1}},line:16},"1":{name:"printReq",decl:{start:{line:20,column:9},end:{line:20,column:17}},loc:{start:{line:20,column:23},end:{line:24,column:1}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:28,column:6},end:{line:28,column:7}},loc:{start:{line:28,column:26},end:{line:48,column:2}},line:28},"3":{name:"(anonymous_3)",decl:{start:{line:49,column:6},end:{line:49,column:7}},loc:{start:{line:49,column:20},end:{line:55,column:2}},line:49},"4":{name:"(anonymous_4)",decl:{start:{line:57,column:19},end:{line:57,column:20}},loc:{start:{line:57,column:39},end:{line:65,column:1}},line:57},"5":{name:"(anonymous_5)",decl:{start:{line:69,column:7},end:{line:69,column:8}},loc:{start:{line:69,column:27},end:{line:97,column:2}},line:69},"6":{name:"(anonymous_6)",decl:{start:{line:98,column:6},end:{line:98,column:7}},loc:{start:{line:98,column:26},end:{line:106,column:2}},line:98},"7":{name:"(anonymous_7)",decl:{start:{line:108,column:17},end:{line:108,column:18}},loc:{start:{line:108,column:23},end:{line:110,column:1}},line:108}},branchMap:{"0":{loc:{start:{line:23,column:1},end:{line:23,column:75}},type:"if",locations:[{start:{line:23,column:1},end:{line:23,column:75}},{start:{line:23,column:1},end:{line:23,column:75}}],line:23},"1":{loc:{start:{line:33,column:2},end:{line:38,column:3}},type:"if",locations:[{start:{line:33,column:2},end:{line:38,column:3}},{start:{line:33,column:2},end:{line:38,column:3}}],line:33},"2":{loc:{start:{line:33,column:6},end:{line:33,column:37}},type:"binary-expr",locations:[{start:{line:33,column:6},end:{line:33,column:16}},{start:{line:33,column:20},end:{line:33,column:27}},{start:{line:33,column:31},end:{line:33,column:37}}],line:33},"3":{loc:{start:{line:45,column:16},end:{line:45,column:41}},type:"cond-expr",locations:[{start:{line:45,column:27},end:{line:45,column:35}},{start:{line:45,column:38},end:{line:45,column:41}}],line:45},"4":{loc:{start:{line:53,column:2},end:{line:54,column:50}},type:"if",locations:[{start:{line:53,column:2},end:{line:54,column:50}},{start:{line:53,column:2},end:{line:54,column:50}}],line:53},"5":{loc:{start:{line:63,column:1},end:{line:63,column:71}},type:"if",locations:[{start:{line:63,column:1},end:{line:63,column:71}},{start:{line:63,column:1},end:{line:63,column:71}}],line:63},"6":{loc:{start:{line:77,column:2},end:{line:80,column:76}},type:"if",locations:[{start:{line:77,column:2},end:{line:80,column:76}},{start:{line:77,column:2},end:{line:80,column:76}}],line:77},"7":{loc:{start:{line:77,column:6},end:{line:77,column:50}},type:"binary-expr",locations:[{start:{line:77,column:6},end:{line:77,column:26}},{start:{line:77,column:30},end:{line:77,column:50}}],line:77},"8":{loc:{start:{line:84,column:2},end:{line:87,column:69}},type:"if",locations:[{start:{line:84,column:2},end:{line:87,column:69}},{start:{line:84,column:2},end:{line:87,column:69}}],line:84},"9":{loc:{start:{line:88,column:2},end:{line:88,column:53}},type:"if",locations:[{start:{line:88,column:2},end:{line:88,column:53}},{start:{line:88,column:2},end:{line:88,column:53}}],line:88},"10":{loc:{start:{line:104,column:2},end:{line:105,column:34}},type:"if",locations:[{start:{line:104,column:2},end:{line:105,column:34}},{start:{line:104,column:2},end:{line:105,column:34}}],line:104}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"44c87ad55328fbe5e45cde1d68abff27b597bc3d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2931p54gwd=function(){return actualCoverage;};}return actualCoverage;}cov_2931p54gwd();const express=(cov_2931p54gwd().s[0]++,require("express"));const https=(cov_2931p54gwd().s[1]++,require("https"));const bodyParser=(cov_2931p54gwd().s[2]++,require("body-parser"));const dataService=(cov_2931p54gwd().s[3]++,require("./db/dataService"));const spotify=(cov_2931p54gwd().s[4]++,require("./plugins/spotify"));const skmeans=(cov_2931p54gwd().s[5]++,require("skmeans"));const listManager=(cov_2931p54gwd().s[6]++,require("./plugins/listManager"));const app=(cov_2931p54gwd().s[7]++,express());cov_2931p54gwd().s[8]++;app.use(bodyParser.urlencoded({extended:true}));cov_2931p54gwd().s[9]++;app.use(bodyParser.json());const client_id=(cov_2931p54gwd().s[10]++,"5a7933f0c4da42ae8a33a0041257cbfd");cov_2931p54gwd().s[11]++;app.get("/status",(req,res)=>{cov_2931p54gwd().f[0]++;cov_2931p54gwd().s[12]++;res.send("<h1>Server is running<h1>");});function printReq(req){cov_2931p54gwd().f[1]++;cov_2931p54gwd().s[13]++;console.log("Request body: "+JSON.stringify(req.body));cov_2931p54gwd().s[14]++;console.log("Request headers: "+JSON.stringify(req.headers));cov_2931p54gwd().s[15]++;if(req.query){cov_2931p54gwd().b[0][0]++;cov_2931p54gwd().s[16]++;console.log("Request query: "+JSON.stringify(req.query));}else{cov_2931p54gwd().b[0][1]++;}}cov_2931p54gwd().s[17]++;app.route("/party").put(async(req,res)=>{cov_2931p54gwd().f[2]++;cov_2931p54gwd().s[18]++;console.log("put request on /party");let partyName=(cov_2931p54gwd().s[19]++,req.body.name);let userId=(cov_2931p54gwd().s[20]++,req.body.userId);let token=(cov_2931p54gwd().s[21]++,req.body.token);cov_2931p54gwd().s[22]++;if((cov_2931p54gwd().b[2][0]++,!partyName)||(cov_2931p54gwd().b[2][1]++,!userId)||(cov_2931p54gwd().b[2][2]++,!token)){cov_2931p54gwd().b[1][0]++;cov_2931p54gwd().s[23]++;res.status=400;cov_2931p54gwd().s[24]++;res.statusMessage="Bad Request";// console.log(req.body);
cov_2931p54gwd().s[25]++;res.send();}else{cov_2931p54gwd().b[1][1]++;}cov_2931p54gwd().s[26]++;try{let partyId=(cov_2931p54gwd().s[27]++,await dataService.createParty(partyName,userId,token));let responseData=(cov_2931p54gwd().s[28]++,{});cov_2931p54gwd().s[29]++;responseData.partyId=partyId;cov_2931p54gwd().s[30]++;res.send(JSON.stringify(responseData));}catch(e){let status=(cov_2931p54gwd().s[31]++,e.status?(cov_2931p54gwd().b[3][0]++,e.status):(cov_2931p54gwd().b[3][1]++,500));cov_2931p54gwd().s[32]++;res.status(status).send(e.message);}}).get((req,res)=>{cov_2931p54gwd().f[3]++;cov_2931p54gwd().s[33]++;console.log("get request on /party");let partyIds=(cov_2931p54gwd().s[34]++,req.query.ids);let info=(cov_2931p54gwd().s[35]++,dataService.getInfo(partyIds));cov_2931p54gwd().s[36]++;if(!info.length){cov_2931p54gwd().b[4][0]++;cov_2931p54gwd().s[37]++;res.status(404).send("Party not found.");}else{cov_2931p54gwd().b[4][1]++;cov_2931p54gwd().s[38]++;res.status(200).send(JSON.stringify(info));}});cov_2931p54gwd().s[39]++;app.get("/search",async(req,res)=>{cov_2931p54gwd().f[4]++;cov_2931p54gwd().s[40]++;console.log("get request on /search");let key=(cov_2931p54gwd().s[41]++,req.query.key);let id=(cov_2931p54gwd().s[42]++,req.query.partyId);let token=(cov_2931p54gwd().s[43]++,dataService.getToken(id));let tracks=(cov_2931p54gwd().s[44]++,await spotify.searchTrack(key,token));cov_2931p54gwd().s[45]++;if(tracks.status){cov_2931p54gwd().b[5][0]++;cov_2931p54gwd().s[46]++;res.status(track.status).send(track.statusMessage);}else{cov_2931p54gwd().b[5][1]++;}cov_2931p54gwd().s[47]++;res.send(tracks);});cov_2931p54gwd().s[48]++;app.route("/playlist").post(async(req,res)=>{cov_2931p54gwd().f[5]++;cov_2931p54gwd().s[49]++;console.log("post request on /playlist");let partyId=(cov_2931p54gwd().s[50]++,req.body.partyId);let trackUri=(cov_2931p54gwd().s[51]++,req.body.trackUri);// console.log(req.body);
let playlistId=(cov_2931p54gwd().s[52]++,dataService.getPlaylistId(partyId));let token=(cov_2931p54gwd().s[53]++,dataService.getToken(partyId));let result=(cov_2931p54gwd().s[54]++,await spotify.addTrackToPlaylist(playlistId,token,trackUri));cov_2931p54gwd().s[55]++;if((cov_2931p54gwd().b[7][0]++,result.status!=200)&&(cov_2931p54gwd().b[7][1]++,result.status!=201)){cov_2931p54gwd().b[6][0]++;cov_2931p54gwd().s[56]++;res.status(result.status).send("Couldn't post the song on the Playlist "+result.statusMessage);}else{cov_2931p54gwd().b[6][1]++;}let data=(cov_2931p54gwd().s[57]++,await spotify.getPlaylistItems(playlistId,token));// console.log(data);
cov_2931p54gwd().s[58]++;if(data.status){cov_2931p54gwd().b[8][0]++;cov_2931p54gwd().s[59]++;res.status(data.status).send("Couldn't get songs from playlist: "+data.statusMessage);}else{cov_2931p54gwd().b[8][1]++;}cov_2931p54gwd().s[60]++;if(data.length<4){cov_2931p54gwd().b[9][0]++;cov_2931p54gwd().s[61]++;return res.status(200).send();}else{cov_2931p54gwd().b[9][1]++;}let rearrangeResult=(cov_2931p54gwd().s[62]++,await listManager.rearrangePlaylist(playlistId,token,data));// console.log(rearrangeResult);
cov_2931p54gwd().s[63]++;res.status(rearrangeResult.status).send(rearrangeResult.message);}).get(async(req,res)=>{cov_2931p54gwd().f[6]++;cov_2931p54gwd().s[64]++;console.log("get request on /playlist");let partyId=(cov_2931p54gwd().s[65]++,req.query.partyId);let playlistId=(cov_2931p54gwd().s[66]++,dataService.getPlaylistId(partyId));let token=(cov_2931p54gwd().s[67]++,dataService.getToken(partyId));let data=(cov_2931p54gwd().s[68]++,await spotify.getPlaylistItems(playlistId,token));cov_2931p54gwd().s[69]++;if(data.status){cov_2931p54gwd().b[10][0]++;cov_2931p54gwd().s[70]++;res.status(data.status).send(data.statusMessage);}else{cov_2931p54gwd().b[10][1]++;cov_2931p54gwd().s[71]++;res.status(200).send(data);}});cov_2931p54gwd().s[72]++;app.listen(8124,()=>{cov_2931p54gwd().f[7]++;cov_2931p54gwd().s[73]++;console.log("server started on port 8124");});cov_2931p54gwd().s[74]++;module.exports=app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImh0dHBzIiwiYm9keVBhcnNlciIsImRhdGFTZXJ2aWNlIiwic3BvdGlmeSIsInNrbWVhbnMiLCJsaXN0TWFuYWdlciIsImFwcCIsInVzZSIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImpzb24iLCJjbGllbnRfaWQiLCJnZXQiLCJyZXEiLCJyZXMiLCJzZW5kIiwicHJpbnRSZXEiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImJvZHkiLCJoZWFkZXJzIiwicXVlcnkiLCJyb3V0ZSIsInB1dCIsInBhcnR5TmFtZSIsIm5hbWUiLCJ1c2VySWQiLCJ0b2tlbiIsInN0YXR1cyIsInN0YXR1c01lc3NhZ2UiLCJwYXJ0eUlkIiwiY3JlYXRlUGFydHkiLCJyZXNwb25zZURhdGEiLCJlIiwibWVzc2FnZSIsInBhcnR5SWRzIiwiaWRzIiwiaW5mbyIsImdldEluZm8iLCJsZW5ndGgiLCJrZXkiLCJpZCIsImdldFRva2VuIiwidHJhY2tzIiwic2VhcmNoVHJhY2siLCJ0cmFjayIsInBvc3QiLCJ0cmFja1VyaSIsInBsYXlsaXN0SWQiLCJnZXRQbGF5bGlzdElkIiwicmVzdWx0IiwiYWRkVHJhY2tUb1BsYXlsaXN0IiwiZGF0YSIsImdldFBsYXlsaXN0SXRlbXMiLCJyZWFycmFuZ2VSZXN1bHQiLCJyZWFycmFuZ2VQbGF5bGlzdCIsImxpc3RlbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiIwc1JBZVk7MkZBZlosS0FBTUEsQ0FBQUEsT0FBTywwQkFBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBVixDQUFiLENBQ0EsS0FBTUMsQ0FBQUEsS0FBSywwQkFBR0QsT0FBTyxDQUFDLE9BQUQsQ0FBVixDQUFYLENBQ0EsS0FBTUUsQ0FBQUEsVUFBVSwwQkFBR0YsT0FBTyxDQUFDLGFBQUQsQ0FBVixDQUFoQixDQUNBLEtBQU1HLENBQUFBLFdBQVcsMEJBQUdILE9BQU8sQ0FB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QixDQUFBQSxJQUFJLDJCQUFHLEtBQU1uRCxDQUFBQSxPQUFPLENBQUNvRCxnQkFBUixDQUF5QkwsVUFBekIsQ0FBcUNyQixLQUFyQyxDQUFULENBQVIsQ0FMd0IseUJBTXhCLEdBQUl5QixJQUFJLENBQUN4QixNQUFULENBQWlCLHNEQUFBaEIsR0FBRyxDQUFDZ0IsTUFBSixDQUFXd0IsSUFBSSxDQUFDeEIsTUFBaEIsRUFBd0JmLElBQXhCLENBQTZCdUMsSUFBSSxDQUFDdkIsYUFBbEMsRUFBaUQsQ0FBbEUsSUFDSyxzREFBQWpCLEdBQUcsQ0FBQ2dCLE1BQUosQ0FBVyxHQUFYLEVBQWdCZixJQUFoQixDQUFxQnVDLElBQXJCLEVBQTJCLENBQ2hDLENBdkNGLEUseUJBeUNBaEQsR0FBRyxDQUFDb0QsTUFBSixDQUFXLElBQVgsQ0FBaUIsSUFBTSxrREFDdEJ6QyxPQUFPLENBQUNDLEdBQVIsQ0FBWSw2QkFBWixFQUNBLENBRkQsRSx5QkFJQXlDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQnRELEdBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xyXG5jb25zdCBodHRwcyA9IHJlcXVpcmUoXCJodHRwc1wiKTtcclxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoXCJib2R5LXBhcnNlclwiKTtcclxuY29uc3QgZGF0YVNlcnZpY2UgPSByZXF1aXJlKFwiLi9kYi9kYXRhU2VydmljZVwiKTtcclxuY29uc3Qgc3BvdGlmeSA9IHJlcXVpcmUoXCIuL3BsdWdpbnMvc3BvdGlmeVwiKTtcclxuY29uc3Qgc2ttZWFucyA9IHJlcXVpcmUoXCJza21lYW5zXCIpO1xyXG5jb25zdCBsaXN0TWFuYWdlciA9IHJlcXVpcmUoXCIuL3BsdWdpbnMvbGlzdE1hbmFnZXJcIik7XHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcblxyXG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTtcclxuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XHJcblxyXG5jb25zdCBjbGllbnRfaWQgPSBcIjVhNzkzM2YwYzRkYTQyYWU4YTMzYTAwNDEyNTdjYmZkXCI7XHJcblxyXG5hcHAuZ2V0KFwiL3N0YXR1c1wiLCAocmVxLCByZXMpID0+IHtcclxuXHRyZXMuc2VuZChcIjxoMT5TZXJ2ZXIgaXMgcnVubmluZzxoMT5cIik7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gcHJpbnRSZXEocmVxKSB7XHJcblx0Y29uc29sZS5sb2coXCJSZXF1ZXN0IGJvZHk6IFwiICsgSlNPTi5zdHJpbmdpZnkocmVxLmJvZHkpKTtcclxuXHRjb25zb2xlLmxvZyhcIlJlcXVlc3QgaGVhZGVyczogXCIgKyBKU09OLnN0cmluZ2lmeShyZXEuaGVhZGVycykpO1xyXG5cdGlmIChyZXEucXVlcnkpIGNvbnNvbGUubG9nKFwiUmVxdWVzdCBxdWVyeTogXCIgKyBKU09OLnN0cmluZ2lmeShyZXEucXVlcnkpKTtcclxufVxyXG5cclxuYXBwXHJcblx0LnJvdXRlKFwiL3BhcnR5XCIpXHJcblx0LnB1dChhc3luYyAocmVxLCByZXMpID0+IHtcclxuXHRcdGNvbnNvbGUubG9nKFwicHV0IHJlcXVlc3Qgb24gL3BhcnR5XCIpO1xyXG5cdFx0bGV0IHBhcnR5TmFtZSA9IHJlcS5ib2R5Lm5hbWU7XHJcblx0XHRsZXQgdXNlcklkID0gcmVxLmJvZHkudXNlcklkO1xyXG5cdFx0bGV0IHRva2VuID0gcmVxLmJvZHkudG9rZW47XHJcblx0XHRpZiAoIXBhcnR5TmFtZSB8fCAhdXNlcklkIHx8ICF0b2tlbikge1xyXG5cdFx0XHRyZXMuc3RhdHVzID0gNDAwO1xyXG5cdFx0XHRyZXMuc3RhdHVzTWVzc2FnZSA9IFwiQmFkIFJlcXVlc3RcIjtcclxuXHRcdFx0Ly8gY29uc29sZS5sb2cocmVxLmJvZHkpO1xyXG5cdFx0XHRyZXMuc2VuZCgpO1xyXG5cdFx0fVxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0bGV0IHBhcnR5SWQgPSBhd2FpdCBkYXRhU2VydmljZS5jcmVhdGVQYXJ0eShwYXJ0eU5hbWUsIHVzZXJJZCwgdG9rZW4pO1xyXG5cdFx0XHRsZXQgcmVzcG9uc2VEYXRhID0ge307XHJcblx0XHRcdHJlc3BvbnNlRGF0YS5wYXJ0eUlkID0gcGFydHlJZDtcclxuXHRcdFx0cmVzLnNlbmQoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhKSk7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGxldCBzdGF0dXMgPSBlLnN0YXR1cyA/IGUuc3RhdHVzIDogNTAwO1xyXG5cdFx0XHRyZXMuc3RhdHVzKHN0YXR1cykuc2VuZChlLm1lc3NhZ2UpO1xyXG5cdFx0fVxyXG5cdH0pXHJcblx0LmdldCgocmVxLCByZXMpID0+IHtcclxuXHRcdGNvbnNvbGUubG9nKFwiZ2V0IHJlcXVlc3Qgb24gL3BhcnR5XCIpO1xyXG5cdFx0bGV0IHBhcnR5SWRzID0gcmVxLnF1ZXJ5LmlkcztcclxuXHRcdGxldCBpbmZvID0gZGF0YVNlcnZpY2UuZ2V0SW5mbyhwYXJ0eUlkcyk7XHJcblx0XHRpZiAoIWluZm8ubGVuZ3RoKSByZXMuc3RhdHVzKDQwNCkuc2VuZChcIlBhcnR5IG5vdCBmb3VuZC5cIik7XHJcblx0XHRlbHNlIHJlcy5zdGF0dXMoMjAwKS5zZW5kKEpTT04uc3RyaW5naWZ5KGluZm8pKTtcclxuXHR9KTtcclxuXHJcbmFwcC5nZXQoXCIvc2VhcmNoXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG5cdGNvbnNvbGUubG9nKFwiZ2V0IHJlcXVlc3Qgb24gL3NlYXJjaFwiKTtcclxuXHRsZXQga2V5ID0gcmVxLnF1ZXJ5LmtleTtcclxuXHRsZXQgaWQgPSByZXEucXVlcnkucGFydHlJZDtcclxuXHRsZXQgdG9rZW4gPSBkYXRhU2VydmljZS5nZXRUb2tlbihpZCk7XHJcblx0bGV0IHRyYWNrcyA9IGF3YWl0IHNwb3RpZnkuc2VhcmNoVHJhY2soa2V5LCB0b2tlbik7XHJcblx0aWYgKHRyYWNrcy5zdGF0dXMpIHJlcy5zdGF0dXModHJhY2suc3RhdHVzKS5zZW5kKHRyYWNrLnN0YXR1c01lc3NhZ2UpO1xyXG5cdHJlcy5zZW5kKHRyYWNrcyk7XHJcbn0pO1xyXG5cclxuYXBwXHJcblx0LnJvdXRlKFwiL3BsYXlsaXN0XCIpXHJcblx0LnBvc3QoYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcblx0XHRjb25zb2xlLmxvZyhcInBvc3QgcmVxdWVzdCBvbiAvcGxheWxpc3RcIik7XHJcblx0XHRsZXQgcGFydHlJZCA9IHJlcS5ib2R5LnBhcnR5SWQ7XHJcblx0XHRsZXQgdHJhY2tVcmkgPSByZXEuYm9keS50cmFja1VyaTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKHJlcS5ib2R5KTtcclxuXHRcdGxldCBwbGF5bGlzdElkID0gZGF0YVNlcnZpY2UuZ2V0UGxheWxpc3RJZChwYXJ0eUlkKTtcclxuXHRcdGxldCB0b2tlbiA9IGRhdGFTZXJ2aWNlLmdldFRva2VuKHBhcnR5SWQpO1xyXG5cdFx0bGV0IHJlc3VsdCA9IGF3YWl0IHNwb3RpZnkuYWRkVHJhY2tUb1BsYXlsaXN0KHBsYXlsaXN0SWQsIHRva2VuLCB0cmFja1VyaSk7XHJcblx0XHRpZiAocmVzdWx0LnN0YXR1cyAhPSAyMDAgJiYgcmVzdWx0LnN0YXR1cyAhPSAyMDEpXHJcblx0XHRcdHJlc1xyXG5cdFx0XHRcdC5zdGF0dXMocmVzdWx0LnN0YXR1cylcclxuXHRcdFx0XHQuc2VuZChcIkNvdWxkbid0IHBvc3QgdGhlIHNvbmcgb24gdGhlIFBsYXlsaXN0IFwiICsgcmVzdWx0LnN0YXR1c01lc3NhZ2UpO1xyXG5cclxuXHRcdGxldCBkYXRhID0gYXdhaXQgc3BvdGlmeS5nZXRQbGF5bGlzdEl0ZW1zKHBsYXlsaXN0SWQsIHRva2VuKTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cdFx0aWYgKGRhdGEuc3RhdHVzKVxyXG5cdFx0XHRyZXNcclxuXHRcdFx0XHQuc3RhdHVzKGRhdGEuc3RhdHVzKVxyXG5cdFx0XHRcdC5zZW5kKFwiQ291bGRuJ3QgZ2V0IHNvbmdzIGZyb20gcGxheWxpc3Q6IFwiICsgZGF0YS5zdGF0dXNNZXNzYWdlKTtcclxuXHRcdGlmIChkYXRhLmxlbmd0aCA8IDQpIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCgpO1xyXG5cclxuXHRcdGxldCByZWFycmFuZ2VSZXN1bHQgPSBhd2FpdCBsaXN0TWFuYWdlci5yZWFycmFuZ2VQbGF5bGlzdChcclxuXHRcdFx0cGxheWxpc3RJZCxcclxuXHRcdFx0dG9rZW4sXHJcblx0XHRcdGRhdGFcclxuXHRcdCk7XHJcblx0XHQvLyBjb25zb2xlLmxvZyhyZWFycmFuZ2VSZXN1bHQpO1xyXG5cdFx0cmVzLnN0YXR1cyhyZWFycmFuZ2VSZXN1bHQuc3RhdHVzKS5zZW5kKHJlYXJyYW5nZVJlc3VsdC5tZXNzYWdlKTtcclxuXHR9KVxyXG5cdC5nZXQoYXN5bmMgKHJlcSwgcmVzKSA9PiB7XHJcblx0XHRjb25zb2xlLmxvZyhcImdldCByZXF1ZXN0IG9uIC9wbGF5bGlzdFwiKTtcclxuXHRcdGxldCBwYXJ0eUlkID0gcmVxLnF1ZXJ5LnBhcnR5SWQ7XHJcblx0XHRsZXQgcGxheWxpc3RJZCA9IGRhdGFTZXJ2aWNlLmdldFBsYXlsaXN0SWQocGFydHlJZCk7XHJcblx0XHRsZXQgdG9rZW4gPSBkYXRhU2VydmljZS5nZXRUb2tlbihwYXJ0eUlkKTtcclxuXHRcdGxldCBkYXRhID0gYXdhaXQgc3BvdGlmeS5nZXRQbGF5bGlzdEl0ZW1zKHBsYXlsaXN0SWQsIHRva2VuKTtcclxuXHRcdGlmIChkYXRhLnN0YXR1cykgcmVzLnN0YXR1cyhkYXRhLnN0YXR1cykuc2VuZChkYXRhLnN0YXR1c01lc3NhZ2UpO1xyXG5cdFx0ZWxzZSByZXMuc3RhdHVzKDIwMCkuc2VuZChkYXRhKTtcclxuXHR9KTtcclxuXHJcbmFwcC5saXN0ZW4oODEyNCwgKCkgPT4ge1xyXG5cdGNvbnNvbGUubG9nKFwic2VydmVyIHN0YXJ0ZWQgb24gcG9ydCA4MTI0XCIpO1xyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gYXBwO1xyXG4iXX0=