function cov_2if0wvecr8(){var path="D:\\Mag\\lets_party_together\\server\\server.js";var hash="2b12a4e1a5b934be42aab58cb0c865844a98b123";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"D:\\Mag\\lets_party_together\\server\\server.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:34}},"1":{start:{line:2,column:14},end:{line:2,column:30}},"2":{start:{line:3,column:19},end:{line:3,column:41}},"3":{start:{line:4,column:20},end:{line:4,column:47}},"4":{start:{line:5,column:16},end:{line:5,column:44}},"5":{start:{line:7,column:12},end:{line:7,column:21}},"6":{start:{line:9,column:0},end:{line:9,column:50}},"7":{start:{line:10,column:0},end:{line:10,column:27}},"8":{start:{line:12,column:18},end:{line:12,column:52}},"9":{start:{line:14,column:0},end:{line:16,column:3}},"10":{start:{line:15,column:4},end:{line:15,column:42}},"11":{start:{line:19,column:4},end:{line:19,column:61}},"12":{start:{line:20,column:4},end:{line:20,column:67}},"13":{start:{line:21,column:4},end:{line:22,column:67}},"14":{start:{line:22,column:8},end:{line:22,column:67}},"15":{start:{line:25,column:0},end:{line:54,column:6}},"16":{start:{line:27,column:8},end:{line:27,column:45}},"17":{start:{line:28,column:24},end:{line:28,column:37}},"18":{start:{line:29,column:21},end:{line:29,column:36}},"19":{start:{line:30,column:20},end:{line:30,column:34}},"20":{start:{line:31,column:8},end:{line:36,column:9}},"21":{start:{line:32,column:12},end:{line:32,column:29}},"22":{start:{line:33,column:12},end:{line:33,column:46}},"23":{start:{line:35,column:12},end:{line:35,column:23}},"24":{start:{line:37,column:8},end:{line:46,column:9}},"25":{start:{line:38,column:26},end:{line:38,column:81}},"26":{start:{line:39,column:32},end:{line:39,column:34}},"27":{start:{line:40,column:12},end:{line:40,column:43}},"28":{start:{line:41,column:12},end:{line:41,column:51}},"29":{start:{line:44,column:25},end:{line:44,column:49}},"30":{start:{line:45,column:12},end:{line:45,column:47}},"31":{start:{line:49,column:8},end:{line:49,column:45}},"32":{start:{line:50,column:23},end:{line:50,column:36}},"33":{start:{line:51,column:19},end:{line:51,column:48}},"34":{start:{line:52,column:8},end:{line:53,column:56}},"35":{start:{line:52,column:26},end:{line:52,column:67}},"36":{start:{line:53,column:13},end:{line:53,column:56}},"37":{start:{line:56,column:0},end:{line:64,column:2}},"38":{start:{line:57,column:4},end:{line:57,column:42}},"39":{start:{line:58,column:14},end:{line:58,column:27}},"40":{start:{line:59,column:13},end:{line:59,column:30}},"41":{start:{line:60,column:16},end:{line:60,column:40}},"42":{start:{line:61,column:17},end:{line:61,column:54}},"43":{start:{line:62,column:4},end:{line:62,column:74}},"44":{start:{line:62,column:23},end:{line:62,column:74}},"45":{start:{line:63,column:4},end:{line:63,column:21}},"46":{start:{line:66,column:0},end:{line:85,column:6}},"47":{start:{line:68,column:8},end:{line:68,column:49}},"48":{start:{line:69,column:22},end:{line:69,column:38}},"49":{start:{line:70,column:23},end:{line:70,column:40}},"50":{start:{line:71,column:8},end:{line:71,column:30}},"51":{start:{line:72,column:25},end:{line:72,column:59}},"52":{start:{line:73,column:20},end:{line:73,column:49}},"53":{start:{line:74,column:21},end:{line:74,column:82}},"54":{start:{line:75,column:8},end:{line:75,column:61}},"55":{start:{line:78,column:8},end:{line:78,column:48}},"56":{start:{line:79,column:22},end:{line:79,column:39}},"57":{start:{line:80,column:25},end:{line:80,column:59}},"58":{start:{line:81,column:20},end:{line:81,column:49}},"59":{start:{line:82,column:19},end:{line:82,column:68}},"60":{start:{line:83,column:8},end:{line:84,column:40}},"61":{start:{line:83,column:24},end:{line:83,column:73}},"62":{start:{line:84,column:13},end:{line:84,column:40}},"63":{start:{line:87,column:0},end:{line:89,column:3}},"64":{start:{line:88,column:4},end:{line:88,column:47}},"65":{start:{line:91,column:0},end:{line:91,column:21}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:14,column:19},end:{line:14,column:20}},loc:{start:{line:14,column:34},end:{line:16,column:1}},line:14},"1":{name:"printReq",decl:{start:{line:18,column:9},end:{line:18,column:17}},loc:{start:{line:18,column:23},end:{line:23,column:1}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:26,column:9},end:{line:26,column:10}},loc:{start:{line:26,column:29},end:{line:47,column:5}},line:26},"3":{name:"(anonymous_3)",decl:{start:{line:48,column:9},end:{line:48,column:10}},loc:{start:{line:48,column:24},end:{line:54,column:5}},line:48},"4":{name:"(anonymous_4)",decl:{start:{line:56,column:19},end:{line:56,column:20}},loc:{start:{line:56,column:40},end:{line:64,column:1}},line:56},"5":{name:"(anonymous_5)",decl:{start:{line:67,column:10},end:{line:67,column:11}},loc:{start:{line:67,column:31},end:{line:76,column:5}},line:67},"6":{name:"(anonymous_6)",decl:{start:{line:77,column:9},end:{line:77,column:10}},loc:{start:{line:77,column:30},end:{line:85,column:5}},line:77},"7":{name:"(anonymous_7)",decl:{start:{line:87,column:17},end:{line:87,column:18}},loc:{start:{line:87,column:24},end:{line:89,column:1}},line:87}},branchMap:{"0":{loc:{start:{line:21,column:4},end:{line:22,column:67}},type:"if",locations:[{start:{line:21,column:4},end:{line:22,column:67}},{start:{line:21,column:4},end:{line:22,column:67}}],line:21},"1":{loc:{start:{line:31,column:8},end:{line:36,column:9}},type:"if",locations:[{start:{line:31,column:8},end:{line:36,column:9}},{start:{line:31,column:8},end:{line:36,column:9}}],line:31},"2":{loc:{start:{line:31,column:13},end:{line:31,column:46}},type:"binary-expr",locations:[{start:{line:31,column:13},end:{line:31,column:23}},{start:{line:31,column:28},end:{line:31,column:35}},{start:{line:31,column:40},end:{line:31,column:46}}],line:31},"3":{loc:{start:{line:44,column:25},end:{line:44,column:49}},type:"cond-expr",locations:[{start:{line:44,column:35},end:{line:44,column:43}},{start:{line:44,column:46},end:{line:44,column:49}}],line:44},"4":{loc:{start:{line:52,column:8},end:{line:53,column:56}},type:"if",locations:[{start:{line:52,column:8},end:{line:53,column:56}},{start:{line:52,column:8},end:{line:53,column:56}}],line:52},"5":{loc:{start:{line:62,column:4},end:{line:62,column:74}},type:"if",locations:[{start:{line:62,column:4},end:{line:62,column:74}},{start:{line:62,column:4},end:{line:62,column:74}}],line:62},"6":{loc:{start:{line:83,column:8},end:{line:84,column:40}},type:"if",locations:[{start:{line:83,column:8},end:{line:84,column:40}},{start:{line:83,column:8},end:{line:84,column:40}}],line:83}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2b12a4e1a5b934be42aab58cb0c865844a98b123"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2if0wvecr8=function(){return actualCoverage;};}return actualCoverage;}cov_2if0wvecr8();const express=(cov_2if0wvecr8().s[0]++,require("express"));const https=(cov_2if0wvecr8().s[1]++,require("https"));const bodyParser=(cov_2if0wvecr8().s[2]++,require('body-parser'));const dataService=(cov_2if0wvecr8().s[3]++,require("./db/dataService"));const spotify=(cov_2if0wvecr8().s[4]++,require("./plugins/spotify"));const app=(cov_2if0wvecr8().s[5]++,express());cov_2if0wvecr8().s[6]++;app.use(bodyParser.urlencoded({extended:true}));cov_2if0wvecr8().s[7]++;app.use(bodyParser.json());const client_id=(cov_2if0wvecr8().s[8]++,'5a7933f0c4da42ae8a33a0041257cbfd');cov_2if0wvecr8().s[9]++;app.get('/status',(req,res)=>{cov_2if0wvecr8().f[0]++;cov_2if0wvecr8().s[10]++;res.send('<h1>Server is running<h1>');});function printReq(req){cov_2if0wvecr8().f[1]++;cov_2if0wvecr8().s[11]++;console.log('Request body: '+JSON.stringify(req.body));cov_2if0wvecr8().s[12]++;console.log('Request headers: '+JSON.stringify(req.headers));cov_2if0wvecr8().s[13]++;if(req.query){cov_2if0wvecr8().b[0][0]++;cov_2if0wvecr8().s[14]++;console.log('Request query: '+JSON.stringify(req.query));}else{cov_2if0wvecr8().b[0][1]++;}}cov_2if0wvecr8().s[15]++;app.route('/party').put(async(req,res)=>{cov_2if0wvecr8().f[2]++;cov_2if0wvecr8().s[16]++;console.log("put request on /party");let partyName=(cov_2if0wvecr8().s[17]++,req.body.name);let userId=(cov_2if0wvecr8().s[18]++,req.body.userId);let token=(cov_2if0wvecr8().s[19]++,req.body.token);cov_2if0wvecr8().s[20]++;if((cov_2if0wvecr8().b[2][0]++,!partyName)||(cov_2if0wvecr8().b[2][1]++,!userId)||(cov_2if0wvecr8().b[2][2]++,!token)){cov_2if0wvecr8().b[1][0]++;cov_2if0wvecr8().s[21]++;res.status=400;cov_2if0wvecr8().s[22]++;res.statusMessage='Bad Request';// console.log(req.body); 
cov_2if0wvecr8().s[23]++;res.send();}else{cov_2if0wvecr8().b[1][1]++;}cov_2if0wvecr8().s[24]++;try{let partyId=(cov_2if0wvecr8().s[25]++,await dataService.createParty(partyName,userId,token));let responseData=(cov_2if0wvecr8().s[26]++,{});cov_2if0wvecr8().s[27]++;responseData.partyId=partyId;cov_2if0wvecr8().s[28]++;res.send(JSON.stringify(responseData));}catch(e){let status=(cov_2if0wvecr8().s[29]++,e.status?(cov_2if0wvecr8().b[3][0]++,e.status):(cov_2if0wvecr8().b[3][1]++,500));cov_2if0wvecr8().s[30]++;res.status(status).send(e.message);}}).get((req,res)=>{cov_2if0wvecr8().f[3]++;cov_2if0wvecr8().s[31]++;console.log('get request on /party');let partyIds=(cov_2if0wvecr8().s[32]++,req.query.ids);let info=(cov_2if0wvecr8().s[33]++,dataService.getInfo(partyIds));cov_2if0wvecr8().s[34]++;if(!info.length){cov_2if0wvecr8().b[4][0]++;cov_2if0wvecr8().s[35]++;res.status(404).send("Party not found.");}else{cov_2if0wvecr8().b[4][1]++;cov_2if0wvecr8().s[36]++;res.status(200).send(JSON.stringify(info));}});cov_2if0wvecr8().s[37]++;app.get('/search',async(req,res)=>{cov_2if0wvecr8().f[4]++;cov_2if0wvecr8().s[38]++;console.log('get request on /search');let key=(cov_2if0wvecr8().s[39]++,req.query.key);let id=(cov_2if0wvecr8().s[40]++,req.query.partyId);let token=(cov_2if0wvecr8().s[41]++,dataService.getToken(id));let tracks=(cov_2if0wvecr8().s[42]++,await spotify.searchTrack(key,token));cov_2if0wvecr8().s[43]++;if(tracks.status){cov_2if0wvecr8().b[5][0]++;cov_2if0wvecr8().s[44]++;res.status(track.status).send(track.statusMessage);}else{cov_2if0wvecr8().b[5][1]++;}cov_2if0wvecr8().s[45]++;res.send(tracks);});cov_2if0wvecr8().s[46]++;app.route('/playlist').post(async(req,res)=>{cov_2if0wvecr8().f[5]++;cov_2if0wvecr8().s[47]++;console.log('post request on /playlist');let partyId=(cov_2if0wvecr8().s[48]++,req.body.partyId);let trackUri=(cov_2if0wvecr8().s[49]++,req.body.trackUri);cov_2if0wvecr8().s[50]++;console.log(req.body);let playlistId=(cov_2if0wvecr8().s[51]++,dataService.getPlaylistId(partyId));let token=(cov_2if0wvecr8().s[52]++,dataService.getToken(partyId));let result=(cov_2if0wvecr8().s[53]++,await spotify.addTrackToPlaylist(playlistId,token,trackUri));cov_2if0wvecr8().s[54]++;res.status(result.status).send(result.statusMessage);}).get(async(req,res)=>{cov_2if0wvecr8().f[6]++;cov_2if0wvecr8().s[55]++;console.log('get request on /playlist');let partyId=(cov_2if0wvecr8().s[56]++,req.query.partyId);let playlistId=(cov_2if0wvecr8().s[57]++,dataService.getPlaylistId(partyId));let token=(cov_2if0wvecr8().s[58]++,dataService.getToken(partyId));let data=(cov_2if0wvecr8().s[59]++,await spotify.getPlaylistItems(playlistId,token));cov_2if0wvecr8().s[60]++;if(data.status){cov_2if0wvecr8().b[6][0]++;cov_2if0wvecr8().s[61]++;res.status(data.status).send(data.statusMessage);}else{cov_2if0wvecr8().b[6][1]++;cov_2if0wvecr8().s[62]++;res.status(200).send(data);}});cov_2if0wvecr8().s[63]++;app.listen(8124,()=>{cov_2if0wvecr8().f[7]++;cov_2if0wvecr8().s[64]++;console.log('server started on port 8124');});cov_2if0wvecr8().s[65]++;module.exports=app;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImh0dHBzIiwiYm9keVBhcnNlciIsImRhdGFTZXJ2aWNlIiwic3BvdGlmeSIsImFwcCIsInVzZSIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImpzb24iLCJjbGllbnRfaWQiLCJnZXQiLCJyZXEiLCJyZXMiLCJzZW5kIiwicHJpbnRSZXEiLCJjb25zb2xlIiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsImJvZHkiLCJoZWFkZXJzIiwicXVlcnkiLCJyb3V0ZSIsInB1dCIsInBhcnR5TmFtZSIsIm5hbWUiLCJ1c2VySWQiLCJ0b2tlbiIsInN0YXR1cyIsInN0YXR1c01lc3NhZ2UiLCJwYXJ0eUlkIiwiY3JlYXRlUGFydHkiLCJyZXNwb25zZURhdGEiLCJlIiwibWVzc2FnZSIsInBhcnR5SWRzIiwiaWRzIiwiaW5mbyIsImdldEluZm8iLCJsZW5ndGgiLCJrZXkiLCJpZCIsImdldFRva2VuIiwidHJhY2tzIiwic2VhcmNoVHJhY2siLCJ0cmFjayIsInBvc3QiLCJ0cmFja1VyaSIsInBsYXlsaXN0SWQiLCJnZXRQbGF5bGlzdElkIiwicmVzdWx0IiwiYWRkVHJhY2tUb1BsYXlsaXN0IiwiZGF0YSIsImdldFBsYXlsaXN0SXRlbXMiLCJsaXN0ZW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoieXhPQWVZOzJGQWZaLEtBQU1BLENBQUFBLE9BQU8sMEJBQUdDLE9BQU8sQ0FBQyxTQUFELENBQVYsQ0FBYixDQUNBLEtBQU1DLENBQUFBLEtBQUssMEJBQUdELE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1FLENBQUFBLFVBQVUsMEJBQUdGLE9BQU8sQ0FBQyxhQUFELENBQVYsQ0FBaEIsQ0FDQSxLQUFNRyxDQUFBQSxXQUFXLDBCQUFHSCxPQUFPLENBQUMsa0JBQUQsQ0FBVixDQUFqQixDQUNBLEtBQU1JLENBQUFBLE9BQU8sMEJBQUdKLE9BQU8sQ0FBQyxtQkFB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QUlILENBQUFBLEtBQUssMkJBQUd6QixXQUFXLENBQUN3QyxRQUFaLENBQXFCWixPQUFyQixDQUFILENBQVQsQ0FDQSxHQUFJc0IsQ0FBQUEsSUFBSSwyQkFBRyxLQUFNakQsQ0FBQUEsT0FBTyxDQUFDa0QsZ0JBQVIsQ0FBeUJMLFVBQXpCLENBQXFDckIsS0FBckMsQ0FBVCxDQUFSLENBTHNCLHlCQU10QixHQUFHeUIsSUFBSSxDQUFDeEIsTUFBUixDQUFnQixxREFBQWhCLEdBQUcsQ0FBQ2dCLE1BQUosQ0FBV3dCLElBQUksQ0FBQ3hCLE1BQWhCLEVBQXdCZixJQUF4QixDQUE2QnVDLElBQUksQ0FBQ3ZCLGFBQWxDLEVBQWlELENBQWpFLElBQ0sscURBQUFqQixHQUFHLENBQUNnQixNQUFKLENBQVcsR0FBWCxFQUFnQmYsSUFBaEIsQ0FBcUJ1QyxJQUFyQixFQUEyQixDQUNuQyxDQW5CTCxFLHlCQXFCQWhELEdBQUcsQ0FBQ2tELE1BQUosQ0FBVyxJQUFYLENBQWlCLElBQU8sa0RBQ3BCdkMsT0FBTyxDQUFDQyxHQUFSLENBQVksNkJBQVosRUFDSCxDQUZELEUseUJBSUF1QyxNQUFNLENBQUNDLE9BQVAsQ0FBaUJwRCxHQUFqQiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTsgXHJcbmNvbnN0IGh0dHBzID0gcmVxdWlyZShcImh0dHBzXCIpOyBcclxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7IFxyXG5jb25zdCBkYXRhU2VydmljZSA9IHJlcXVpcmUoXCIuL2RiL2RhdGFTZXJ2aWNlXCIpOyBcclxuY29uc3Qgc3BvdGlmeSA9IHJlcXVpcmUoXCIuL3BsdWdpbnMvc3BvdGlmeVwiKTsgXHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7IFxyXG5cclxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoIHtleHRlbmRlZDp0cnVlIH0pKTsgXHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKCkpOyBcclxuXHJcbmNvbnN0IGNsaWVudF9pZCA9ICc1YTc5MzNmMGM0ZGE0MmFlOGEzM2EwMDQxMjU3Y2JmZCc7IFxyXG5cclxuYXBwLmdldCgnL3N0YXR1cycsIChyZXEsIHJlcykgPT4gIHtcclxuICAgIHJlcy5zZW5kKCc8aDE+U2VydmVyIGlzIHJ1bm5pbmc8aDE+Jyk7IFxyXG59KTsgXHJcblxyXG5mdW5jdGlvbiBwcmludFJlcShyZXEpIHtcclxuICAgIGNvbnNvbGUubG9nKCdSZXF1ZXN0IGJvZHk6ICcgKyBKU09OLnN0cmluZ2lmeShyZXEuYm9keSkpOyBcclxuICAgIGNvbnNvbGUubG9nKCdSZXF1ZXN0IGhlYWRlcnM6ICcgKyBKU09OLnN0cmluZ2lmeShyZXEuaGVhZGVycykpOyBcclxuICAgIGlmKHJlcS5xdWVyeSlcclxuICAgICAgICBjb25zb2xlLmxvZygnUmVxdWVzdCBxdWVyeTogJyArIEpTT04uc3RyaW5naWZ5KHJlcS5xdWVyeSkpOyBcclxufVxyXG5cclxuYXBwLnJvdXRlKCcvcGFydHknKVxyXG4gICAgLnB1dChhc3luYyAocmVxLCByZXMpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInB1dCByZXF1ZXN0IG9uIC9wYXJ0eVwiKTsgXHJcbiAgICAgICAgbGV0IHBhcnR5TmFtZSA9IHJlcS5ib2R5Lm5hbWU7IFxyXG4gICAgICAgIGxldCB1c2VySWQgPSByZXEuYm9keS51c2VySWQ7IFxyXG4gICAgICAgIGxldCB0b2tlbiA9IHJlcS5ib2R5LnRva2VuOyBcclxuICAgICAgICBpZiAoICFwYXJ0eU5hbWUgfHwgICF1c2VySWQgfHwgICF0b2tlbikge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzID0gNDAwOyBcclxuICAgICAgICAgICAgcmVzLnN0YXR1c01lc3NhZ2UgPSAnQmFkIFJlcXVlc3QnOyBcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVxLmJvZHkpOyBcclxuICAgICAgICAgICAgcmVzLnNlbmQoKTsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJ0eUlkID0gYXdhaXQgZGF0YVNlcnZpY2UuY3JlYXRlUGFydHkocGFydHlOYW1lLCB1c2VySWQsIHRva2VuKTsgXHJcbiAgICAgICAgICAgIGxldCByZXNwb25zZURhdGEgPSAge31cclxuICAgICAgICAgICAgcmVzcG9uc2VEYXRhLnBhcnR5SWQgPSBwYXJ0eUlkOyBcclxuICAgICAgICAgICAgcmVzLnNlbmQoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhKSk7IFxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBsZXQgc3RhdHVzID0gZS5zdGF0dXM/IGUuc3RhdHVzIDogNTAwOyBcclxuICAgICAgICAgICAgcmVzLnN0YXR1cyhzdGF0dXMpLnNlbmQoZS5tZXNzYWdlKTsgXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5nZXQoKHJlcSwgcmVzKSA9PiAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdnZXQgcmVxdWVzdCBvbiAvcGFydHknKTtcclxuICAgICAgICBsZXQgcGFydHlJZHMgPSByZXEucXVlcnkuaWRzOyBcclxuICAgICAgICBsZXQgaW5mbyA9IGRhdGFTZXJ2aWNlLmdldEluZm8ocGFydHlJZHMpOyBcclxuICAgICAgICBpZiAoIWluZm8ubGVuZ3RoKSByZXMuc3RhdHVzKDQwNCkuc2VuZChcIlBhcnR5IG5vdCBmb3VuZC5cIik7IFxyXG4gICAgICAgIGVsc2UgcmVzLnN0YXR1cygyMDApLnNlbmQoSlNPTi5zdHJpbmdpZnkoaW5mbykpOyBcclxuICAgIH0pXHJcblxyXG5hcHAuZ2V0KCcvc2VhcmNoJywgYXN5bmMgKHJlcSwgcmVzKSA9PiAge1xyXG4gICAgY29uc29sZS5sb2coJ2dldCByZXF1ZXN0IG9uIC9zZWFyY2gnKTsgXHJcbiAgICBsZXQga2V5ID0gcmVxLnF1ZXJ5LmtleTsgXHJcbiAgICBsZXQgaWQgPSByZXEucXVlcnkucGFydHlJZDsgXHJcbiAgICBsZXQgdG9rZW4gPSBkYXRhU2VydmljZS5nZXRUb2tlbihpZCk7IFxyXG4gICAgbGV0IHRyYWNrcyA9IGF3YWl0IHNwb3RpZnkuc2VhcmNoVHJhY2soa2V5LCB0b2tlbik7IFxyXG4gICAgaWYgKHRyYWNrcy5zdGF0dXMpIHJlcy5zdGF0dXModHJhY2suc3RhdHVzKS5zZW5kKHRyYWNrLnN0YXR1c01lc3NhZ2UpOyBcclxuICAgIHJlcy5zZW5kKHRyYWNrcyk7IFxyXG59KVxyXG5cclxuYXBwLnJvdXRlKCcvcGxheWxpc3QnKVxyXG4gICAgLnBvc3QoYXN5bmMgKHJlcSwgcmVzKSA9PiAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdwb3N0IHJlcXVlc3Qgb24gL3BsYXlsaXN0Jyk7IFxyXG4gICAgICAgIGxldCBwYXJ0eUlkID0gcmVxLmJvZHkucGFydHlJZDsgXHJcbiAgICAgICAgbGV0IHRyYWNrVXJpID0gcmVxLmJvZHkudHJhY2tVcmk7IFxyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcS5ib2R5KTsgXHJcbiAgICAgICAgbGV0IHBsYXlsaXN0SWQgPSBkYXRhU2VydmljZS5nZXRQbGF5bGlzdElkKHBhcnR5SWQpOyBcclxuICAgICAgICBsZXQgdG9rZW4gPSBkYXRhU2VydmljZS5nZXRUb2tlbihwYXJ0eUlkKTsgXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHNwb3RpZnkuYWRkVHJhY2tUb1BsYXlsaXN0KHBsYXlsaXN0SWQsIHRva2VuLCB0cmFja1VyaSk7IFxyXG4gICAgICAgIHJlcy5zdGF0dXMocmVzdWx0LnN0YXR1cykuc2VuZChyZXN1bHQuc3RhdHVzTWVzc2FnZSk7IFxyXG4gICAgfSlcclxuICAgIC5nZXQoYXN5bmMgKHJlcSwgcmVzKSA9PiAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdnZXQgcmVxdWVzdCBvbiAvcGxheWxpc3QnKTsgXHJcbiAgICAgICAgbGV0IHBhcnR5SWQgPSByZXEucXVlcnkucGFydHlJZDsgXHJcbiAgICAgICAgbGV0IHBsYXlsaXN0SWQgPSBkYXRhU2VydmljZS5nZXRQbGF5bGlzdElkKHBhcnR5SWQpOyBcclxuICAgICAgICBsZXQgdG9rZW4gPSBkYXRhU2VydmljZS5nZXRUb2tlbihwYXJ0eUlkKTsgXHJcbiAgICAgICAgbGV0IGRhdGEgPSBhd2FpdCBzcG90aWZ5LmdldFBsYXlsaXN0SXRlbXMocGxheWxpc3RJZCwgdG9rZW4pOyBcclxuICAgICAgICBpZihkYXRhLnN0YXR1cykgcmVzLnN0YXR1cyhkYXRhLnN0YXR1cykuc2VuZChkYXRhLnN0YXR1c01lc3NhZ2UpOyBcclxuICAgICAgICBlbHNlIHJlcy5zdGF0dXMoMjAwKS5zZW5kKGRhdGEpOyBcclxuICAgIH0pXHJcblxyXG5hcHAubGlzdGVuKDgxMjQsICgpID0+ICB7XHJcbiAgICBjb25zb2xlLmxvZygnc2VydmVyIHN0YXJ0ZWQgb24gcG9ydCA4MTI0Jyk7IFxyXG59KTsgXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGFwcDsgIl19